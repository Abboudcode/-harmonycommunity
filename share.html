<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <title>Share a Story ‚Äì Harmony Community</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="Share your real family story ‚Äì with your name or completely anonymous ‚Äì in a calm, safe space."
  />

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --bg: #f5f7fb;
      --bg-card: #ffffff;
      --primary: #4b6fff;
      --primary-soft: #e2e7ff;
      --text-main: #1f2933;
      --text-muted: #6b7280;
      --border-soft: #e5e7eb;
      --accent: #10b981;
      --danger: #ef4444;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 10px 25px rgba(15, 23, 42, 0.08);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
      "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #eef2ff, #f9fafb 40%);
      color: var(--text-main);
      line-height: 1.6;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .max-w {
      max-width: 1080px;
      margin: 0 auto;
      padding: 0 1.25rem;
    }

    /* HEADER / NAV */

    header {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: blur(16px);
      background: linear-gradient(180deg, #050817, #0f172a);
      border-bottom: 1px solid rgba(148, 163, 184, 0.35);
    }

    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.8rem 0;
      gap: 1rem;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .logo-wrapper {
      display: flex;
      align-items: center;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 0.95rem;
      color: #e5e7eb;
    }

    .nav-links a {
      padding: 0.3rem 0.6rem;
      border-radius: 999px;
      transition: background 0.2s, color 0.2s;
    }

    .nav-links a:hover {
      background: rgba(148, 163, 184, 0.22);
      color: #ffffff;
    }

    .nav-links a.active {
      background: rgba(129, 140, 248, 0.35);
      color: #ffffff;
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .nav-ghost {
      font-size: 0.9rem;
      color: #cbd5f5;
      white-space: nowrap;
    }

    .language-select {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.8);
      color: #e5e7eb;
      font-size: 0.8rem;
      padding: 0.25rem 0.7rem;
      outline: none;
      cursor: pointer;
    }

    .language-select option {
      color: #111827;
      background: #ffffff;
    }

    @media (max-width: 720px) {
      .nav-links {
        display: none;
      }
    }

    /* BUTTONS */

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: #fff;
      border-radius: 999px;
      padding: 0.6rem 1.3rem;
      font-size: 0.95rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      box-shadow: 0 12px 30px rgba(79, 70, 229, 0.35);
      transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.1s ease;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 35px rgba(79, 70, 229, 0.45);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 10px 25px rgba(79, 70, 229, 0.3);
      opacity: 0.9;
    }

    .btn-secondary {
      background: #eef2ff;
      color: #4f46e5;
      border-radius: 999px;
      padding: 0.55rem 1.2rem;
      font-size: 0.92rem;
      font-weight: 500;
      border: 1px solid #c7d2fe;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s;
    }

    .btn-secondary:hover {
      background: #e0e7ff;
      border-color: #a5b4fc;
    }

    /* LAYOUT */

    main {
      padding: 2.8rem 0 2.2rem;
    }

    .page-title-block {
      max-width: 720px;
      margin: 0 auto 1.8rem;
      text-align: center;
    }

    .page-title-block h1 {
      font-size: 1.6rem;
      margin-bottom: 0.4rem;
    }

    .page-title-block p {
      font-size: 0.95rem;
      color: var(--text-muted);
    }

    .two-col {
      display: grid;
      grid-template-columns: minmax(0, 1.8fr) minmax(0, 1.5fr);
      gap: 1.8rem;
    }

    @media (max-width: 900px) {
      .two-col {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 1.4rem 1.3rem;
      border: 1px solid var(--border-soft);
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.03);
      transition: box-shadow 0.15s ease, transform 0.15s ease, border-color 0.15s ease;
    }

    .card:hover {
      box-shadow: 0 16px 35px rgba(15, 23, 42, 0.07);
      transform: translateY(-2px);
      border-color: #e5e7eb;
    }

    .card h3 {
      font-size: 1.05rem;
      margin-bottom: 0.4rem;
    }

    .card p.sub {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 1rem;
    }

    .field {
      margin-bottom: 0.9rem;
      font-size: 0.9rem;
    }

    .field label {
      display: block;
      margin-bottom: 0.25rem;
      font-weight: 500;
    }

    .field input[type="text"],
    .field input[type="email"],
    .field input[type="password"],
    .field select,
    .field textarea {
      width: 100%;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      padding: 0.55rem 0.7rem;
      font-family: inherit;
      font-size: 0.9rem;
      transition: border-color 0.12s ease, box-shadow 0.12s ease;
    }

    .field input:focus,
    .field select:focus,
    .field textarea:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.25);
    }

    .field textarea {
      resize: vertical;
      min-height: 140px;
    }

    .field input[type="file"] {
      font-size: 0.85rem;
    }

    .field small {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .field-inline {
      display: flex;
      align-items: flex-start;
      gap: 0.45rem;
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 0.8rem;
    }

    .field-inline input[type="checkbox"] {
      margin-top: 0.1rem;
    }

    .note {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.6rem;
      font-size: 0.8rem;
    }

    .pill {
      padding: 0.2rem 0.6rem;
      border-radius: 999px;
      background: #eef2ff;
      color: #4f46e5;
      border: 1px solid #c7d2fe;
    }

    .example-block {
      font-size: 0.86rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
      line-height: 1.7;
    }

    .example-label {
      font-size: 0.78rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: #9ca3af;
      margin-bottom: 0.25rem;
    }

    .success-message,
    .error-message {
      margin-top: 0.75rem;
      padding: 0.6rem 0.8rem;
      border-radius: 10px;
      font-size: 0.82rem;
    }

    .success-message {
      background: #ecfdf5;
      border: 1px solid #bbf7d0;
      color: #166534;
    }

    .error-message {
      background: #fef2f2;
      border: 1px solid #fecaca;
      color: #b91c1c;
    }

    footer {
      padding: 1rem 0 1.5rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      text-align: center;
      margin-top: auto;
    }

    @media (max-width: 640px) {
      main {
        padding-top: 2.2rem;
      }

      .nav {
        padding: 0.6rem 0;
      }

      .card {
        padding: 1.2rem 1.05rem;
      }
    }
  </style>
</head>
<body>
<div class="page">
  <!-- HEADER -->
  <header>
    <div class="max-w nav">
      <div class="nav-left">
        <div class="logo-wrapper">
          <!-- Arc + heartbeat + Harmony text logo -->
          <svg
            width="180"
            height="40"
            viewBox="0 0 180 40"
            xmlns="http://www.w3.org/2000/svg"
            aria-label="Harmony logo"
            role="img"
          >
            <!-- Arc -->
            <path
              d="M10 22 C25 5, 55 5, 70 22"
              fill="none"
              stroke="#40cbb4"
              stroke-width="3"
              stroke-linecap="round"
            />
            <!-- Heartbeat / wave -->
            <path
              d="M12 22 L22 22 L27 15 L33 30 L38 22 L68 22"
              fill="none"
              stroke="#f5c451"
              stroke-width="3"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <!-- Text -->
            <text
              x="78"
              y="27"
              font-family="Inter, system-ui, sans-serif"
              font-size="18"
              font-weight="600"
              fill="#ffffff"
            >
              Harmony
            </text>
          </svg>
        </div>
      </div>

      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="stories.html">Stories</a>
        <a href="share.html" class="active">Share a Story</a>
        <a href="signin.html">Sign In</a>
        <a href="about.html">About</a>
        <a href="faq.html">FAQ</a>
        <a href="contact.html">Contact</a>
      </nav>

      <div class="nav-right">
        <select id="language-select" class="language-select" aria-label="Choose language">
          <option value="en">English</option>
          <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
        </select>
        <div class="nav-ghost" id="nav-auth-label">
          Not signed in
        </div>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main>
    <div class="max-w page-title-block">
      <h1
        data-en="Share what‚Äôs really happening at home"
        data-ar="ÿ•ÿ≠ŸÉŸä ÿ¥Ÿà ŸÅÿπŸÑÿßŸã ÿπŸÖ ŸäÿµŸäÿ± ÿ®ÿ®Ÿäÿ™ŸÉ"
      >
        Share what‚Äôs really happening at home
      </h1>
      <p
        data-en="Write your story in a calm, private space. You can show your name or choose to stay completely anonymous."
        data-ar="ÿ•ŸÉÿ™ÿ® ŸÇÿµÿ™ŸÉ ÿ®ŸÖŸÉÿßŸÜ ŸáÿßÿØŸä Ÿàÿ≥ÿ±Ÿä. ÿ™ŸÇÿØÿ± ÿ™ÿ∏Ÿáÿ± ÿßÿ≥ŸÖŸÉ ÿ£Ÿà ÿ™ÿÆÿ™ÿßÿ± ÿ™ŸÉŸàŸÜ ŸÖÿ¨ŸáŸàŸÑ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ."
      >
        Write your story in a calm, private space. You can show your name or choose to stay completely anonymous.
      </p>
    </div>

    <section>
      <div class="max-w two-col">
        <!-- FORM SIDE -->
        <div class="card">
          <h3
            data-en="Your story"
            data-ar="ŸÇÿµÿ™ŸÉ"
          >
            Your story
          </h3>
          <p
            class="sub"
            data-en="Take your time. You don‚Äôt have to be perfect or polite here. Just be honest."
            data-ar="ÿÆÿØ ŸàŸÇÿ™ŸÉ. ŸÖÿ¥ ŸÑÿßÿ≤ŸÖ ÿ™ŸÉŸàŸÜ ŸÖŸÜŸÖŸëŸÇ ÿ£Ÿà ŸÖÿ´ÿßŸÑŸä ŸáŸàŸÜ. ÿ®ÿ≥ ŸÉŸÜ ÿµÿßÿØŸÇ."
          >
            Take your time. You don‚Äôt have to be perfect or polite here. Just be honest.
          </p>

          <form id="share-form">
            <div class="field">
              <label
                for="story-title"
                data-en="Title"
                data-ar="ÿßŸÑÿπŸÜŸàÿßŸÜ"
              >Title</label>
              <input
                id="story-title"
                type="text"
                required
                placeholder="Example: I feel like I‚Äôm failing as a parent‚Ä¶"
              />
            </div>

            <div class="field">
              <label
                for="story-category"
                data-en="Category"
                data-ar="ÿßŸÑŸÅÿ¶ÿ©"
              >Category</label>
              <select id="story-category" required>
                <option value="Kids">Kids</option>
                <option value="Teens">Teens</option>
                <option value="Adult">Adult</option>
                <option value="Marriage">Marriage</option>
                <option value="Finance">Finance</option>
              </select>
            </div>

            <div class="field">
              <label
                for="story-details"
                data-en="Details"
                data-ar="ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ"
              >Details</label>
              <textarea
                id="story-details"
                required
                placeholder="Share what‚Äôs going on, how it makes you feel, and what you wish someone could tell you right now‚Ä¶"
              ></textarea>
            </div>

            <div class="field">
              <label
                for="story-media"
                data-en="Attach a picture or video (optional)"
                data-ar="ÿ•ÿ±ŸÅŸÇ ÿµŸàÿ±ÿ© ÿ£Ÿà ŸÅŸäÿØŸäŸà (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)"
              >Attach a picture or video (optional)</label>
              <input id="story-media" type="file" />
              <small
                data-en="In the full app, screenshots or photos can help others understand your situation better."
                data-ar="ŸÅŸä ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑŸÉÿßŸÖŸÑÿ©ÿå ŸÑŸÇÿ∑ÿßÿ™ ÿßŸÑÿ¥ÿßÿ¥ÿ© ÿ£Ÿà ÿßŸÑÿµŸàÿ± ÿ™ÿ≥ÿßÿπÿØ ÿßŸÑŸÜÿßÿ≥ ŸäŸÅŸáŸÖŸàÿß Ÿàÿ∂ÿπŸÉ ÿ£ŸÉÿ´ÿ±."
              >
                In the full app, screenshots or photos can help others understand your situation better.
              </small>
            </div>

            <div class="field-inline">
              <input id="story-anon" type="checkbox" />
              <label for="story-anon">
                <strong
                  data-en="Post this story as Anonymous"
                  data-ar="ÿ£ŸÜÿ¥ÿ± Ÿáÿ∞Ÿá ÿßŸÑŸÇÿµÿ© ŸÉŸÖÿ¨ŸáŸàŸÑ"
                >
                  Post this story as Anonymous
                </strong><br />
                <small
                  data-en="If checked, people will see ‚ÄúAnonymous‚Äù instead of your name for this story."
                  data-ar="ÿ•ÿ∞ÿß ŸÅÿπŸëŸÑÿ™ Ÿáÿ∞ÿß ÿßŸÑÿÆŸäÿßÿ±ÿå ÿßŸÑŸÜÿßÿ≥ ÿ±ÿ≠ ÿ™ÿ¥ŸàŸÅ &quot;ŸÖÿ¨ŸáŸàŸÑ&quot; ÿ®ÿØŸÑ ÿßÿ≥ŸÖŸÉ ŸÅŸä Ÿáÿ∞Ÿá ÿßŸÑŸÇÿµÿ©."
                >
                  If checked, people will see ‚ÄúAnonymous‚Äù instead of your name for this story.
                </small>
              </label>
            </div>

            <p
              class="note"
              id="share-note"
              data-en="Your story will be saved privately in Harmony‚Äôs database. Soon, it will appear on the Stories page so others can react with kindness."
              data-ar="ŸÇÿµÿ™ŸÉ ÿ±ÿ≠ ÿ™ŸÜÿ≠ŸÅÿ∏ ÿ®ÿ¥ŸÉŸÑ ÿÆÿßÿµ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿ®ŸäÿßŸÜÿßÿ™ Ÿáÿßÿ±ŸÖŸàŸÜŸä. ŸÇÿ±Ÿäÿ®ÿßŸãÿå ÿ±ÿ≠ ÿ™ÿ∏Ÿáÿ± ŸÅŸä ÿµŸÅÿ≠ÿ© ÿßŸÑŸÇÿµÿµ ÿ≠ÿ™Ÿâ ÿßŸÑŸÜÿßÿ≥ ÿ™ÿ™ŸÅÿßÿπŸÑ ŸÖÿπŸáÿß ÿ®ŸÑÿ∑ŸÅ."
            >
              Your story will be saved privately in Harmony‚Äôs database. Soon, it will appear on the Stories page so others can react with kindness.
            </p>

            <button
              type="submit"
              class="btn-primary"
              data-en="Share my story"
              data-ar="ÿ£ŸÜÿ¥ÿ± ŸÇÿµÿ™Ÿä"
            >
              Share my story
            </button>

            <div id="share-status"></div>
          </form>
        </div>

        <!-- INFO SIDE -->
        <div class="card">
          <h3
            data-en="Before you share"
            data-ar="ŸÇÿ®ŸÑ ŸÖÿß ÿ™ÿ≠ŸÉŸä"
          >
            Before you share
          </h3>
          <p
            class="sub"
            data-en="Some gentle reminders to help you feel safe and supported while writing."
            data-ar="ÿ¥ŸàŸäÿ© ÿ™ÿ∞ŸÉŸäÿ±ÿßÿ™ ŸÑÿ∑ŸäŸÅÿ© ÿ≠ÿ™Ÿâ ÿ™ÿ≠ÿ≥ ÿ®ÿßŸÑÿ£ŸÖÿßŸÜ ŸàÿßŸÑÿØÿπŸÖ Ÿàÿ£ŸÜÿ™ ÿ™ŸÉÿ™ÿ®."
          >
            Some gentle reminders to help you feel safe and supported while writing.
          </p>

          <div class="pill-row">
            <span class="pill"
                  data-en="No judgment zone"
                  data-ar="ÿ®ÿØŸàŸÜ ÿ≠ŸÉŸÖ ÿ£Ÿà ŸÑŸàŸÖ">
              No judgment zone
            </span>
            <span class="pill"
                  data-en="Real feelings welcome"
                  data-ar="ÿßŸÑŸÖÿ¥ÿßÿπÿ± ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ© ŸÖÿ±ÿ≠Ÿëÿ® ŸÅŸäŸáÿß">
              Real feelings welcome
            </span>
            <span class="pill"
                  data-en="You control your privacy"
                  data-ar="ÿ•ŸÜÿ™ ÿßŸÑŸÖÿ™ÿ≠ŸÉŸëŸÖ ÿ®ÿÆÿµŸàÿµŸäÿ™ŸÉ">
              You control your privacy
            </span>
          </div>

          <div class="example-block">
            <div
              class="example-label"
              data-en="Example way to start"
              data-ar="ÿ∑ÿ±ŸäŸÇÿ© ŸÖÿ´ÿßŸÑ ŸÑÿ®ÿØÿ° ÿßŸÑŸÇÿµÿ©"
            >
              Example way to start
            </div>
            <p
              data-en="‚ÄúI‚Äôm a parent of two kids, and lately I feel like I‚Äôm failing them. I shout more than I want to, and when the house is finally quiet I feel so guilty. I love my kids deeply, but I‚Äôm so tired and I don‚Äôt know how to break this cycle‚Ä¶‚Äù"
              data-ar="¬´ÿ£ŸÜÿß ÿ£ŸÖ/ÿ£ÿ® ŸÑÿ∑ŸÅŸÑŸäŸÜÿå Ÿàÿ®ÿßŸÑŸÅÿ™ÿ±ÿ© ÿßŸÑÿ£ÿÆŸäÿ±ÿ© ÿ≠ÿßÿ≥ÿ≥/ÿ© ÿ•ŸÜŸä ÿπŸÖ ÿ£ŸÅÿ¥ŸÑŸáŸÖ. ÿ£ÿµÿ±ÿÆ ÿ£ŸÉÿ´ÿ± ŸÖŸÖÿß ÿ®ÿØŸäÿå ŸàŸÑŸÖÿß ÿßŸÑÿ®Ÿäÿ™ ŸäŸáÿØÿ£ ÿ®ÿßŸÑÿ¢ÿÆÿ± ÿ®ÿ≠ÿ≥ ÿ®ÿ∞ŸÜÿ® ŸÉÿ®Ÿäÿ±. ÿ®ÿ≠ÿ® ÿ£ŸàŸÑÿßÿØŸä ŸÖŸÜ ŸÇŸÑÿ®Ÿäÿå ÿ®ÿ≥ ÿ£ŸÜÿß ŸÖÿ±ŸáŸÇ/ÿ© ŸàŸÖÿ¥ ÿπÿßÿ±ŸÅ/ÿ© ŸÉŸäŸÅ ÿ£ÿ∑ŸÑÿπ ŸÖŸÜ ŸáÿßŸÑÿØÿßÿ¶ÿ±ÿ©‚Ä¶¬ª"
            >
              ‚ÄúI‚Äôm a parent of two kids, and lately I feel like I‚Äôm failing them. I shout more than I want to, and when the house is finally quiet I feel so guilty. I love my kids deeply, but I‚Äôm so tired and I don‚Äôt know how to break this cycle‚Ä¶‚Äù
            </p>
          </div>

          <div class="example-block" style="margin-top:1.1rem;">
            <div
              class="example-label"
              data-en="What Harmony is ‚Äì and isn‚Äôt"
              data-ar="ÿ¥Ÿà ŸáŸä Ÿáÿßÿ±ŸÖŸàŸÜŸä‚Ä¶ Ÿàÿ¥Ÿà ŸÖÿ¥ ŸáŸä"
            >
              What Harmony is ‚Äì and isn‚Äôt
            </div>
            <p
              data-en="Harmony is a community space for empathy, not a place for medical, legal or professional treatment. If you ever feel in danger or at risk of harming yourself or others, please contact local emergency services or a trusted professional immediately."
              data-ar="Ÿáÿßÿ±ŸÖŸàŸÜŸä ŸÖÿ≥ÿßÿ≠ÿ© ŸÑŸÑÿ™ÿπÿßÿ∑ŸÅ ŸàÿßŸÑÿØÿπŸÖ ÿ®ŸäŸÜ ÿßŸÑŸÜÿßÿ≥ÿå ŸÖÿ¥ ŸÖŸÉÿßŸÜ ŸÑÿπŸÑÿßÿ¨ ÿ∑ÿ®Ÿä ÿ£Ÿà ÿßÿ≥ÿ™ÿ¥ÿßÿ±ÿ© ŸÇÿßŸÜŸàŸÜŸäÿ© ÿ£Ÿà ÿπŸÑÿßÿ¨ ŸÖŸáŸÜŸä. ÿ•ÿ∞ÿß ÿ¥ÿπÿ±ÿ™ ÿ®ÿ£Ÿä ÿÆÿ∑ÿ± ÿπŸÑŸâ ŸÜŸÅÿ≥ŸÉ ÿ£Ÿà ÿπŸÑŸâ ÿ∫Ÿäÿ±ŸÉÿå ÿ™ŸàÿßÿµŸÑ ŸÅŸàÿ±ÿßŸã ŸÖÿπ ÿÆÿØŸÖÿßÿ™ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶ ŸÅŸä ÿ®ŸÑÿØŸÉ ÿ£Ÿà ŸÖÿπ ÿ¥ÿÆÿµ ŸÖŸáŸÜŸä ŸÖŸàÿ´ŸàŸÇ."
            >
              Harmony is a community space for empathy, not a place for medical, legal or professional treatment. If you ever feel in danger or at risk of harming yourself or others, please contact local emergency services or a trusted professional immediately.
            </p>
          </div>

          <div class="example-block" style="margin-top:1.1rem;">
            <div
              class="example-label"
              data-en="Next steps"
              data-ar="ÿßŸÑÿÆÿ∑Ÿàÿßÿ™ ÿßŸÑÿ¨ÿßŸäÿ©"
            >
              Next steps
            </div>
            <p
              data-en="Soon, when the database is fully ready, your stories here will appear on the Stories page so others can react with kindness and share what helped them in similar situations."
              data-ar="ŸÇÿ±Ÿäÿ®ÿßŸãÿå ŸÑŸÖÿß ÿ™ÿ¨Ÿáÿ≤ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿßŸÑŸÉÿßŸÖŸÑÿå ÿßŸÑŸÇÿµÿµ ÿßŸÑŸÑŸä ÿ™ŸÉÿ™ÿ®Ÿáÿß ŸáŸàŸÜ ÿ±ÿ≠ ÿ™ÿ∏Ÿáÿ± ŸÅŸä ÿµŸÅÿ≠ÿ© ÿßŸÑŸÇÿµÿµÿå ÿ≠ÿ™Ÿâ ÿßŸÑŸÜÿßÿ≥ ÿ™ŸÇÿØÿ± ÿ™ÿ™ŸÅÿßÿπŸÑ ŸÖÿπŸáÿß ÿ®ŸÑÿ∑ŸÅ Ÿàÿ™ÿ¥ÿßÿ±ŸÉ ÿ¥Ÿà ÿ≥ÿßÿπÿØŸáŸÖ ŸÅŸä ŸÜŸÅÿ≥ ÿßŸÑÿ∏ÿ±ŸàŸÅ."
            >
              Soon, when the database is fully ready, your stories here will appear on the Stories page so others can react with kindness and share what helped them in similar situations.
            </p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    Harmony Community ¬© 2025
  </footer>
</div>

<!-- Supabase client -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
  (function () {
    const langSelect = document.getElementById('language-select');
    const navAuthLabel = document.getElementById('nav-auth-label');
    const shareForm = document.getElementById('share-form');
    const shareStatus = document.getElementById('share-status');

    // ===== Language handling =====
    function applyLanguage(lang) {
      const elements = document.querySelectorAll('[data-en]');
      elements.forEach(el => {
        const en = el.getAttribute('data-en');
        const ar = el.getAttribute('data-ar') || en;
        el.innerHTML = lang === 'ar' ? ar : en;
      });

      document.documentElement.lang = lang === 'ar' ? 'ar' : 'en';
      document.documentElement.dir  = lang === 'ar' ? 'rtl' : 'ltr';
    }

    // Always start in English
    applyLanguage('en');
    if (langSelect) {
      langSelect.value = 'en';
      langSelect.addEventListener('change', () => {
        const lang = langSelect.value;
        applyLanguage(lang);
      });
    }

    // ===== Supabase client =====
    const SUPABASE_URL = 'https://tnohzvrpqiaiupwyaxcp.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_BkvdSI8x7RxczomMIRAbOA_MLTw8g8K';

    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let cachedUser = null;

    async function getCurrentUser() {
      if (cachedUser !== null) return cachedUser;
      const { data, error } = await supabaseClient.auth.getUser();
      if (error || !data.user) {
        cachedUser = null;
      } else {
        cachedUser = data.user;
      }
      return cachedUser;
    }

    // ===== Header auth label =====
    async function refreshUserLabel() {
      const user = await getCurrentUser();
      if (!user) {
        if (navAuthLabel) {
          navAuthLabel.textContent = 'Not signed in';
        }
        return;
      }

      const meta = user.user_metadata || {};
      const displayName = meta.display_name || user.email;
      const alwaysAnon = !!meta.always_anonymous;

      let label;
      if (alwaysAnon) {
        label = 'Signed in: Anonymous (name hidden)';
      } else {
        label = 'Signed in: ' + displayName;
      }

      if (navAuthLabel) {
        navAuthLabel.textContent = label;
      }
    }

    refreshUserLabel();

    // ===== Helper for status messages =====
    function setStatus(message, type) {
      if (!shareStatus) return;
      if (!message) {
        shareStatus.innerHTML = '';
        return;
      }
      const cls = type === 'error' ? 'error-message' : 'success-message';
      shareStatus.innerHTML = '<div class="' + cls + '">' + message + '</div>';
    }

    // ===== Form submit: insert into Supabase =====
    if (shareForm) {
      shareForm.addEventListener('submit', async function (e) {
        e.preventDefault();
        setStatus('', 'success');

        const titleEl = document.getElementById('story-title');
        const categoryEl = document.getElementById('story-category');
        const detailsEl = document.getElementById('story-details');
        const anonEl = document.getElementById('story-anon');

        const title = titleEl.value.trim();
        const category = categoryEl.value;
        const details = detailsEl.value.trim();
        const anonChecked = anonEl.checked;

        if (!title || !details) {
          setStatus('Please fill the title and details before you share.', 'error');
          return;
        }

        setStatus('Saving your story‚Ä¶', 'success');

        try {
          const user = await getCurrentUser();
          const userId = user ? user.id : null;
          const meta = user ? (user.user_metadata || {}) : {};
          const alwaysAnon = !!meta.always_anonymous;

          const isAnonymous = alwaysAnon || anonChecked;

          const { error } = await supabaseClient
            .from('stories')
            .insert([{
              user_id: userId,          // can be null for guests
              title: title,
              content: details,
              category: category,
              is_anonymous: isAnonymous,
              media_url: null          // we‚Äôll wire this later
            }]);

          if (error) {
            console.error(error);
            setStatus('There was a problem saving your story. Please try again in a moment.', 'error');
            return;
          }

          setStatus(
            'Thank you for trusting Harmony with your story. It was saved safely. Soon it will appear on the Stories page so others can support you. üíõ',
            'success'
          );

          shareForm.reset();
        } catch (err) {
          console.error(err);
          setStatus('Unexpected error while saving your story. Please try again.', 'error');
        }
      });
    }
  })();
</script>
</body>
</html>
